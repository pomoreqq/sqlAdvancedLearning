 Skadnia i dziaanie funkcji okna:

Czym r贸偶ni si RANK() od DENSE_RANK()?
rank moze pomijac liczby jesli pare jest takich samych a dense rank tego nie robi
Czym r贸偶ni si RANK() od ROW_NUMBER()?
no rank robi jakby rankig a row-number ilosc rowow w danym oknie
Co robi NTILE(4)?
dzieli dana kolumne na 4 rowne czesci
Czym r贸偶ni si PARTITION BY od GROUP BY?
to I to grupuje dane ale partition by tworzy okno na podstawie danej kolumny a groupby tworzy jeden row grupy
Jak dziaa ORDER BY wewntrz OVER()?
tak jak na zewnatrz
Co si stanie, jeli pominiesz ORDER BY w funkcji okna?
nic sie nie stanie
W jakiej kolejnoci wykonywane s funkcje okna?
wpierw over() a potem funkcja okienkowa
Jak LAG() i LEAD() traktuj pierwszy i ostatni rekord?
jako nulle
Co zwraca FIRST_VALUE()?
pierwsza wartosc w danym oknie
Co zwraca LAST_VALUE() i kiedy jego wynik mo偶e by mylcy?
kiedy est pare takich samych wartosci?


 Przypadki i logika:

Kiedy OVER(PARTITION BY ...) jest bezu偶yteczne?
kiedy juz pogrupujemy dane wczesniej, lub jesli teoretycznie okieno to jeden row. np id 
Czy mo偶na u偶y OVER() z COUNT()?
chyba tak, ale nie wiem czemu
Jak wyznaczy redni kroczc?
nie wiem?
W czym ROWS BETWEEN jest lepsze od zwykego ORDER BY?
nie mialem tego, ale mysle ze dlatego ze mozemy wybrac dokladne rowy na ktorych robimy order by?
Co robi ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW?
bierze row pomiedzy poprzednim a aktualnym?
Dlaczego AVG(...) OVER() nie daje tego samego co AVG() z GROUP BY?
nie wiem
Jak dziaa RANK() w przypadku remisu?
jest ta sama liczba i pomija nastepna
Czym skutkuje u偶ycie PARTITION BY na unikalnej kolumnie?
taka sama iloscia okienek
Jak wycign "top N per group"?
ntile(n) over(partition by xyz order by abc)
Jak znale藕 r贸偶nic wartoci midzy kolejnymi rekordami w ramach jednej grupy?
trzeba obliczyc dany rekord lub jesli jest to robimy lag na tej kolumnie i tworzymy nowa na podstawie lagu nastepnie odejmujemy 
wartosci z lagu I z dengo rekordu


 Analiza i diagnostyka:

Co jest nie tak w zapytaniu:

SELECT RANK() OVER(PARTITION BY customer_id), customer_id FROM orders;
nie ma order by. w ten sposob jest to bezsensu zapytanie

Co si stanie, jeli u偶yjesz FIRST_VALUE() bez ORDER BY?
randomowy rekord zostanie zwrocony
Dlaczego LAST_VALUE() mo偶e zwraca nie ten rekord, kt贸ry mylisz?
bo zwraca ostatnia wartosc ogolnie a nie w okienku?
Co zwr贸ci LAG(..., 2)?
zacznie zwracac poprzedni row od drugiego rowa?

Co robi NTILE(100) na tabeli z 15 wierszami?
hmm nie wiem

 Mylenie analityczne:

Jak znale藕 klient贸w, kt贸rzy zwikszali swoje wydatki miesic po miesicu?
with cte as ( select customerid,month,sum(amount) as total spend from customers
group by customerid,month
order by customerid,month)
select customerid,month,totalspend,
lag(totalspend) over(partition by customer_id) as priormonth,
totalspend - lag(totalspend) over(partition by customer_id) as monthDiff

Jak przypisa ka偶demu rekordowi warto z poprzedniego miesica?
no metoda lag poprostu.
Jak sprawdzi, czy kt贸ry klient mia 2 takie same patnoci pod rzd?
bym zrobil okienko na customer id I order by order id?
Jak sprawdzi, czy kt贸ry film by wypo偶yczany przez 3 r贸偶ne osoby pod rzd?
nie wiem
Czy mo偶na u偶y funkcji okna bez GROUP BY? Kiedy to ma sens?
chyba chodzilo bez partition by a nie bez grup by?